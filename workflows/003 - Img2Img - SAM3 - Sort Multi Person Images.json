{"id":"2ccbe587-37e6-49a4-8da2-d47bf0a6dfde","revision":0,"last_node_id":430,"last_link_id":961,"nodes":[{"id":264,"type":"Display_Any","pos":[-5730.7387201278125,-833.1310593289577],"size":[140,76],"flags":{},"order":7,"mode":0,"inputs":[{"localized_name":"input","name":"input","type":"*","link":913}],"outputs":[{"localized_name":"STRING","name":"STRING","type":"STRING","links":null}],"title":"TOTAL","properties":{"cnr_id":"kaytool","ver":"0.70.17","Node name for S&R":"Display_Any","ue_properties":{"widget_ue_connectable":{},"version":"7.1","input_ue_unconnectable":{}}},"widgets_values":["1073"],"color":"#432","bgcolor":"#653"},{"id":265,"type":"Display_Any","pos":[-5796.9603828991185,-713.1907755703679],"size":[334.40746855123234,93.65628146104018],"flags":{},"order":8,"mode":0,"inputs":[{"localized_name":"input","name":"input","type":"*","link":914}],"outputs":[{"localized_name":"STRING","name":"STRING","type":"STRING","links":[569]}],"title":"STATUS","properties":{"cnr_id":"kaytool","ver":"0.70.17","Node name for S&R":"Display_Any","ue_properties":{"widget_ue_connectable":{},"version":"7.1","input_ue_unconnectable":{}}},"widgets_values":["Processing [5 of 1073] @ [03:05:46 AM]: 44d4m5_103"],"color":"#432","bgcolor":"#653"},{"id":325,"type":"PreviewImage","pos":[-5430.028269152865,-1715.6386558289255],"size":[501.2040160986644,476.3901929131496],"flags":{},"order":10,"mode":0,"inputs":[{"localized_name":"images","name":"images","type":"IMAGE","link":746}],"outputs":[],"properties":{"cnr_id":"comfy-core","ver":"0.3.77","Node name for S&R":"PreviewImage","ue_properties":{"widget_ue_connectable":{},"version":"7.1","input_ue_unconnectable":{}}},"widgets_values":[]},{"id":417,"type":"Note","pos":[-4409.544750585637,-1636.8197721032316],"size":[338.1914737905604,266.1191717538768],"flags":{},"order":0,"mode":0,"inputs":[],"outputs":[],"title":"SWITCH EXPLAINED","properties":{"ue_properties":{"widget_ue_connectable":{},"version":"7.1","input_ue_unconnectable":{}}},"widgets_values":["If SAM3 only returns 1 mask, there is only one person in the image. There is no need to edit or modify it. So We return input 1 which is the original image.\n\nIf SAM3 returns more than 1 mask, then there is more than one person detected. In this case we return the SAM3 Segmented version of the image since we will need to remove the additional people from the image in the next workflow.\n\nThe original image will always be stored in the \"1\" folder, since it only has one image.\n\nThe images with more than one person are stored in folders with the number of people in each one. This also assists in the next workflow."],"color":"#432","bgcolor":"#653"},{"id":411,"type":"Display_Any","pos":[-4401.4779053157645,-1145.7690361189752],"size":[255.33227330956333,88],"flags":{},"order":16,"mode":0,"inputs":[{"localized_name":"input","name":"input","type":"*","link":927}],"outputs":[{"localized_name":"STRING","name":"STRING","type":"STRING","links":[]}],"title":"IMAGE TYPE SELECTED","properties":{"cnr_id":"kaytool","ver":"0.70.17","Node name for S&R":"Display_Any","ue_properties":{"widget_ue_connectable":{},"version":"7.1","input_ue_unconnectable":{}}},"widgets_values":["1"]},{"id":412,"type":"Display_Any","pos":[-4654.229465893346,-1010.5695355622347],"size":[488.1642287558184,88],"flags":{},"order":14,"mode":0,"inputs":[{"localized_name":"input","name":"input","type":"*","link":934}],"outputs":[{"localized_name":"STRING","name":"STRING","type":"STRING","links":[]}],"title":"NUMBER OF MASKS THAT SAM3 RETURNS (NUM OF PEOPLE)","properties":{"cnr_id":"kaytool","ver":"0.70.17","Node name for S&R":"Display_Any","ue_properties":{"widget_ue_connectable":{},"version":"7.1","input_ue_unconnectable":{}}},"widgets_values":["1"]},{"id":324,"type":"SAM3Segmentation","pos":[-5467.920161112771,-1092.8738901631002],"size":[270,262],"flags":{},"order":9,"mode":0,"inputs":[{"localized_name":"image","name":"image","type":"IMAGE","link":739},{"localized_name":"prompt","name":"prompt","type":"STRING","widget":{"name":"prompt"},"link":null},{"localized_name":"threshold","name":"threshold","type":"FLOAT","widget":{"name":"threshold"},"link":null},{"localized_name":"min_width_pixels","name":"min_width_pixels","type":"INT","widget":{"name":"min_width_pixels"},"link":null},{"localized_name":"min_height_pixels","name":"min_height_pixels","type":"INT","widget":{"name":"min_height_pixels"},"link":null},{"localized_name":"use_video_model","name":"use_video_model","type":"BOOLEAN","widget":{"name":"use_video_model"},"link":null},{"localized_name":"unload_after_run","name":"unload_after_run","type":"BOOLEAN","widget":{"name":"unload_after_run"},"link":null},{"localized_name":"object_ids","name":"object_ids","shape":7,"type":"STRING","widget":{"name":"object_ids"},"link":null}],"outputs":[{"localized_name":"segmented_image","name":"segmented_image","type":"IMAGE","links":[918]},{"localized_name":"masks","name":"masks","type":"MASK","links":[897]},{"localized_name":"mask_combined","name":"mask_combined","type":"MASK","links":[]},{"localized_name":"segs","name":"segs","type":"SEGS","links":null}],"properties":{"Node name for S&R":"SAM3Segmentation","ue_properties":{"widget_ue_connectable":{"prompt":true,"threshold":true,"min_width_pixels":true,"min_height_pixels":true,"use_video_model":true,"unload_after_run":true,"object_ids":true},"version":"7.1","input_ue_unconnectable":{}}},"widgets_values":["person",0.1,0,0,false,false,""]},{"id":266,"type":"BK Print To Console With Boarder","pos":[-5421.856223498668,-744.0590408962971],"size":[310.7681640625,106],"flags":{},"order":11,"mode":0,"inputs":[{"localized_name":"text","name":"text","type":"STRING","widget":{"name":"text"},"link":569},{"localized_name":"char","name":"char","type":"STRING","widget":{"name":"char"},"link":null},{"localized_name":"length","name":"length","type":"INT","widget":{"name":"length"},"link":null}],"outputs":[{"localized_name":"text","name":"text","type":"STRING","links":null}],"properties":{"aux_id":"brandonkish/comfyUI-extractable-text","ver":"700e57effd7190916609392fcea90f47bbbaa3f1","Node name for S&R":"BK Print To Console With Boarder","ue_properties":{"widget_ue_connectable":{"text":true,"char":true,"length":true},"version":"7.1","input_ue_unconnectable":{}}},"widgets_values":["","#",75],"color":"#432","bgcolor":"#653"},{"id":415,"type":"PreviewImage","pos":[-3793.550547986118,-1491.6785513390425],"size":[210,258],"flags":{},"order":18,"mode":0,"inputs":[{"localized_name":"images","name":"images","type":"IMAGE","link":931}],"outputs":[],"title":"SELECTED IMAGE","properties":{"cnr_id":"comfy-core","ver":"0.3.77","Node name for S&R":"PreviewImage","ue_properties":{"widget_ue_connectable":{},"version":"7.1","input_ue_unconnectable":{}}},"widgets_values":[]},{"id":420,"type":"easy int","pos":[-5074.275505739683,-1063.4988535462237],"size":[328.9660673153603,61.275842642476505],"flags":{},"order":1,"mode":0,"inputs":[{"localized_name":"value","name":"value","type":"INT","widget":{"name":"value"},"link":null}],"outputs":[{"localized_name":"int","name":"int","type":"INT","links":[937]}],"title":"SET MAXIMUM INPUT SELECTION","properties":{"cnr_id":"comfyui-easy-use","ver":"1.3.4","Node name for S&R":"easy int","ue_properties":{"widget_ue_connectable":{"value":true},"version":"7.1","input_ue_unconnectable":{}}},"widgets_values":[2]},{"id":408,"type":"MinNode","pos":[-4691.573108173112,-1155.8089216435271],"size":[223.2406131432599,46],"flags":{},"order":13,"mode":0,"inputs":[{"localized_name":"input1","name":"input1","type":"*","link":937},{"localized_name":"input2","name":"input2","type":"*","link":933}],"outputs":[{"localized_name":"*","name":"*","type":"*","links":[922,927,942]}],"title":"SELECT MIN (1 OR 2)","properties":{"cnr_id":"comfyui-logicutils","ver":"1.7.2","Node name for S&R":"MinNode","ue_properties":{"widget_ue_connectable":{},"version":"7.1","input_ue_unconnectable":{}}},"widgets_values":[]},{"id":423,"type":"ImpactSwitch","pos":[-4137.270194487597,-791.404437413588],"size":[270,122],"flags":{},"order":17,"mode":0,"inputs":[{"localized_name":"input1","name":"input1","shape":7,"type":"*","link":943},{"localized_name":"select","name":"select","type":"INT","widget":{"name":"select"},"link":942},{"localized_name":"sel_mode","name":"sel_mode","type":"BOOLEAN","widget":{"name":"sel_mode"},"link":null},{"name":"input2","type":"STRING","link":961},{"name":"input3","type":"STRING","link":null}],"outputs":[{"label":"STRING","localized_name":"selected_value","name":"selected_value","type":"*","links":[946]},{"localized_name":"selected_label","name":"selected_label","type":"STRING","links":null},{"localized_name":"selected_index","name":"selected_index","type":"INT","links":null}],"properties":{"cnr_id":"comfyui-impact-pack","ver":"8.22.2","Node name for S&R":"ImpactSwitch","ue_properties":{"widget_ue_connectable":{"select":true,"sel_mode":true},"version":"7.1","input_ue_unconnectable":{}}},"widgets_values":[1,false]},{"id":242,"type":"BK Load Image By Path","pos":[-5805.263656091432,-1187.425692530105],"size":[270,246],"flags":{},"order":6,"mode":0,"inputs":[{"localized_name":"image_name","name":"image_name","type":"STRING","widget":{"name":"image_name"},"link":909},{"localized_name":"image_directory","name":"image_directory","type":"STRING","widget":{"name":"image_directory"},"link":911},{"localized_name":"extension","name":"extension","type":"STRING","widget":{"name":"extension"},"link":912}],"outputs":[{"localized_name":"image","name":"image","type":"IMAGE","links":[739,746,917,951]},{"localized_name":"mask","name":"mask","type":"MASK","links":[]},{"localized_name":"positive_prompt","name":"positive_prompt","type":"STRING","links":null},{"localized_name":"negative_prompt","name":"negative_prompt","type":"STRING","links":null},{"localized_name":"seed","name":"seed","type":"INT","links":[]},{"localized_name":"other","name":"other","type":"STRING","links":null},{"localized_name":"name","name":"name","type":"STRING","links":[]},{"localized_name":"folder_path","name":"folder_path","type":"STRING","links":null}],"properties":{"aux_id":"brandonkish/comfyUI-extractable-text","ver":"700e57effd7190916609392fcea90f47bbbaa3f1","Node name for S&R":"BK Load Image By Path","ue_properties":{"widget_ue_connectable":{"image_name":true,"image_directory":true,"extension":true},"version":"7.1","input_ue_unconnectable":{}}},"widgets_values":["image","",".png"]},{"id":425,"type":"Display_Any","pos":[-3847.1129864824957,-948.880598120066],"size":[261.63710197933676,89.38847518873138],"flags":{},"order":20,"mode":0,"inputs":[{"localized_name":"input","name":"input","type":"*","link":946}],"outputs":[{"localized_name":"STRING","name":"STRING","type":"STRING","links":[952]}],"title":"SUBFOLDER NAME","properties":{"cnr_id":"kaytool","ver":"0.70.17","Node name for S&R":"Display_Any","ue_properties":{"widget_ue_connectable":{},"version":"7.1","input_ue_unconnectable":{}}},"widgets_values":["single"]},{"id":405,"type":"PrimitiveString","pos":[-3521.7619023639327,-1256.6428410624137],"size":[270,58],"flags":{},"order":2,"mode":0,"inputs":[{"localized_name":"value","name":"value","type":"STRING","widget":{"name":"value"},"link":null}],"outputs":[{"localized_name":"STRING","name":"STRING","type":"STRING","links":[955]}],"title":"DEST FOLDER PATH","properties":{"cnr_id":"comfy-core","ver":"0.3.77","Node name for S&R":"PrimitiveString","ue_properties":{"widget_ue_connectable":{"value":true},"version":"7.1","input_ue_unconnectable":{}}},"widgets_values":["images\\dataset_prep\\multi_person_detect"]},{"id":402,"type":"VHS_GetMaskCount","pos":[-5169.73203229708,-934.2645116660801],"size":[416.7607421875,33.92762991966379],"flags":{},"order":12,"mode":0,"inputs":[{"localized_name":"mask","name":"mask","type":"MASK","link":897}],"outputs":[{"localized_name":"count","name":"count","type":"INT","links":[933,934,958]}],"title":"GET THE NUMBER OF MASKS THAT SAM RETURNED","properties":{"cnr_id":"comfyui-videohelpersuite","ver":"1.7.4","Node name for S&R":"VHS_GetMaskCount","ue_properties":{"widget_ue_connectable":{},"version":"7.1","input_ue_unconnectable":{}}},"widgets_values":{}},{"id":424,"type":"PrimitiveString","pos":[-4576.89495775751,-816.6287144307],"size":[270,58],"flags":{},"order":3,"mode":0,"inputs":[{"localized_name":"value","name":"value","type":"STRING","widget":{"name":"value"},"link":null}],"outputs":[{"localized_name":"STRING","name":"STRING","type":"STRING","links":[943]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.77","Node name for S&R":"PrimitiveString","ue_properties":{"widget_ue_connectable":{"value":true},"version":"7.1","input_ue_unconnectable":{}}},"widgets_values":["single"]},{"id":430,"type":"PrimitiveString","pos":[-4576.691118970361,-706.1115759801487],"size":[270,58],"flags":{},"order":4,"mode":0,"inputs":[{"localized_name":"value","name":"value","type":"STRING","widget":{"name":"value"},"link":null}],"outputs":[{"localized_name":"STRING","name":"STRING","type":"STRING","links":[961]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.77","Node name for S&R":"PrimitiveString","ue_properties":{"widget_ue_connectable":{"value":true},"version":"7.1","input_ue_unconnectable":{}}},"widgets_values":["multi"]},{"id":427,"type":"BK Save Image","pos":[-3077.2073955931264,-1551.6028738618288],"size":[270.08984375,282],"flags":{},"order":22,"mode":0,"inputs":[{"localized_name":"images","name":"images","type":"IMAGE","link":951},{"localized_name":"seed","name":"seed","type":"INT","link":958},{"localized_name":"positive_optional","name":"positive_optional","shape":7,"type":"STRING","link":null},{"localized_name":"negative_optional","name":"negative_optional","shape":7,"type":"STRING","link":null},{"localized_name":"other_optional","name":"other_optional","shape":7,"type":"STRING","link":null},{"localized_name":"filename","name":"filename","type":"STRING","widget":{"name":"filename"},"link":954},{"localized_name":"name_suffix","name":"name_suffix","type":"STRING","widget":{"name":"name_suffix"},"link":null},{"localized_name":"path","name":"path","type":"STRING","widget":{"name":"path"},"link":955},{"localized_name":"subfolder","name":"subfolder","type":"STRING","widget":{"name":"subfolder"},"link":953},{"localized_name":"include_workflow","name":"include_workflow","type":"BOOLEAN","widget":{"name":"include_workflow"},"link":null},{"localized_name":"strip_invalid_chars","name":"strip_invalid_chars","type":"BOOLEAN","widget":{"name":"strip_invalid_chars"},"link":null},{"localized_name":"add_seed_to_name","name":"add_seed_to_name","type":"BOOLEAN","widget":{"name":"add_seed_to_name"},"link":null}],"outputs":[{"localized_name":"IMAGE","name":"IMAGE","type":"IMAGE","links":[950]},{"localized_name":"folderpath","name":"folderpath","type":"STRING","links":null},{"localized_name":"filename","name":"filename","type":"STRING","links":null},{"localized_name":"full_path","name":"full_path","type":"STRING","links":null}],"properties":{"aux_id":"brandonkish/comfyUI-extractable-text","ver":"700e57effd7190916609392fcea90f47bbbaa3f1","Node name for S&R":"BK Save Image","ue_properties":{"widget_ue_connectable":{"filename":true,"name_suffix":true,"path":true,"subfolder":true,"include_workflow":true,"strip_invalid_chars":true,"add_seed_to_name":true},"version":"7.1","input_ue_unconnectable":{}}},"widgets_values":["","","images\\qwen2509\\image_prep","",true,true,false]},{"id":407,"type":"ImpactSwitch","pos":[-4377.537887642859,-1316.3869432197841],"size":[270,122],"flags":{},"order":15,"mode":0,"inputs":[{"localized_name":"input1","name":"input1","shape":7,"type":"*","link":917},{"localized_name":"select","name":"select","type":"INT","widget":{"name":"select"},"link":922},{"localized_name":"sel_mode","name":"sel_mode","type":"BOOLEAN","widget":{"name":"sel_mode"},"link":null},{"name":"input2","type":"IMAGE","link":918},{"name":"input3","type":"IMAGE","link":null}],"outputs":[{"label":"IMAGE","localized_name":"selected_value","name":"selected_value","type":"*","links":[931]},{"localized_name":"selected_label","name":"selected_label","type":"STRING","links":[930]},{"localized_name":"selected_index","name":"selected_index","type":"INT","links":[]}],"properties":{"cnr_id":"comfyui-impact-pack","ver":"8.22.2","Node name for S&R":"ImpactSwitch","ue_properties":{"widget_ue_connectable":{"select":true,"sel_mode":true},"version":"7.1","input_ue_unconnectable":{}}},"widgets_values":[0,false]},{"id":428,"type":"PreviewImage","pos":[-2618.047646038489,-1582.2861970339657],"size":[501.2040160986644,476.3901929131496],"flags":{},"order":23,"mode":0,"inputs":[{"localized_name":"images","name":"images","type":"IMAGE","link":950}],"outputs":[],"properties":{"cnr_id":"comfy-core","ver":"0.3.77","Node name for S&R":"PreviewImage","ue_properties":{"widget_ue_connectable":{},"version":"7.1","input_ue_unconnectable":{}}},"widgets_values":[]},{"id":429,"type":"StringConcatenate","pos":[-3504.845929828982,-1024.8553126490046],"size":[400,200],"flags":{},"order":21,"mode":0,"inputs":[{"localized_name":"string_a","name":"string_a","type":"STRING","widget":{"name":"string_a"},"link":null},{"localized_name":"string_b","name":"string_b","type":"STRING","widget":{"name":"string_b"},"link":952},{"localized_name":"delimiter","name":"delimiter","type":"STRING","widget":{"name":"delimiter"},"link":null}],"outputs":[{"localized_name":"STRING","name":"STRING","type":"STRING","links":[953]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.77","Node name for S&R":"StringConcatenate","ue_properties":{"widget_ue_connectable":{"string_a":true,"string_b":true,"delimiter":true},"version":"7.1","input_ue_unconnectable":{}}},"widgets_values":["","",""]},{"id":414,"type":"Display_Any","pos":[-4051.260928949883,-1140.1102043878689],"size":[523.3597280831327,96.12204783958146],"flags":{},"order":19,"mode":0,"inputs":[{"localized_name":"input","name":"input","type":"*","link":930}],"outputs":[{"localized_name":"STRING","name":"STRING","type":"STRING","links":[]}],"title":"SWITCH STATING WHICH IMAGE IT IS USING, 1 = ORIG, 2= SAM IMG","properties":{"cnr_id":"kaytool","ver":"0.70.17","Node name for S&R":"Display_Any","ue_properties":{"widget_ue_connectable":{},"version":"7.1","input_ue_unconnectable":{}}},"widgets_values":["input1"]},{"id":406,"type":"BK File Selector","pos":[-6435.868297369195,-927.6849206341709],"size":[424.3189089520447,270],"flags":{},"order":5,"mode":0,"inputs":[{"localized_name":"seed","name":"seed","type":"INT","widget":{"name":"seed"},"link":null},{"localized_name":"search_pattern","name":"search_pattern","type":"STRING","widget":{"name":"search_pattern"},"link":null},{"localized_name":"source_path","name":"source_path","type":"STRING","widget":{"name":"source_path"},"link":null}],"outputs":[{"localized_name":"filename","name":"filename","type":"STRING","links":[909,954]},{"localized_name":"folder_path","name":"folder_path","type":"STRING","links":[911]},{"localized_name":"extension","name":"extension","type":"STRING","links":[912]},{"localized_name":"full_path","name":"full_path","type":"STRING","links":null},{"localized_name":"total_files_found","name":"total_files_found","type":"STRING","links":[913]},{"localized_name":"file_list","name":"file_list","type":"STRING","links":null},{"localized_name":"file_list_w_idx","name":"file_list_w_idx","type":"STRING","links":null},{"localized_name":"status","name":"status","type":"STRING","links":[914]}],"properties":{"aux_id":"brandonkish/comfyUI-extractable-text","ver":"700e57effd7190916609392fcea90f47bbbaa3f1","Node name for S&R":"BK File Selector","ue_properties":{"widget_ue_connectable":{"seed":true,"search_pattern":true,"source_path":true},"version":"7.1","input_ue_unconnectable":{}}},"widgets_values":[0,"increment","*.png","images\\dataset_prep\\dataset_1024"]}],"links":[[569,265,0,266,0,"STRING"],[739,242,0,324,0,"IMAGE"],[746,242,0,325,0,"IMAGE"],[897,324,1,402,0,"MASK"],[909,406,0,242,0,"STRING"],[911,406,1,242,1,"STRING"],[912,406,2,242,2,"STRING"],[913,406,4,264,0,"*"],[914,406,7,265,0,"*"],[917,242,0,407,0,"IMAGE"],[918,324,0,407,3,"IMAGE"],[922,408,0,407,1,"INT"],[927,408,0,411,0,"*"],[930,407,1,414,0,"*"],[931,407,0,415,0,"IMAGE"],[933,402,0,408,1,"*"],[934,402,0,412,0,"*"],[937,420,0,408,0,"*"],[942,408,0,423,1,"INT"],[943,424,0,423,0,"*"],[946,423,0,425,0,"*"],[950,427,0,428,0,"IMAGE"],[951,242,0,427,0,"IMAGE"],[952,425,0,429,1,"STRING"],[953,429,0,427,8,"STRING"],[954,406,0,427,5,"STRING"],[955,405,0,427,7,"STRING"],[958,402,0,427,1,"INT"],[961,430,0,423,3,"STRING"]],"groups":[],"config":{},"extra":{"ds":{"scale":0.8140274938683996,"offset":[6476.468523229038,1312.123730953283]},"ue_links":[],"links_added_by_ue":[],"frontendVersion":"1.33.10","VHS_latentpreview":false,"VHS_latentpreviewrate":0,"VHS_MetadataImage":true,"VHS_KeepIntermediate":true,"workflowRendererVersion":"LG"},"version":0.4}