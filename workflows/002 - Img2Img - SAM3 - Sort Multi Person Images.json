{"id":"2ccbe587-37e6-49a4-8da2-d47bf0a6dfde","revision":0,"last_node_id":434,"last_link_id":988,"nodes":[{"id":264,"type":"Display_Any","pos":[-5730.7387201278125,-833.1310593289577],"size":[140,76],"flags":{},"order":3,"mode":0,"inputs":[{"localized_name":"input","name":"input","type":"*","link":985}],"outputs":[{"localized_name":"STRING","name":"STRING","type":"STRING","links":null}],"title":"TOTAL","properties":{"cnr_id":"kaytool","ver":"0.70.17","Node name for S&R":"Display_Any","ue_properties":{"widget_ue_connectable":{},"version":"7.1","input_ue_unconnectable":{}}},"widgets_values":["1"],"color":"#432","bgcolor":"#653"},{"id":265,"type":"Display_Any","pos":[-5796.9603828991185,-713.1907755703679],"size":[334.40746855123234,93.65628146104018],"flags":{},"order":4,"mode":0,"inputs":[{"localized_name":"input","name":"input","type":"*","link":986}],"outputs":[{"localized_name":"STRING","name":"STRING","type":"STRING","links":[569]}],"title":"STATUS","properties":{"cnr_id":"kaytool","ver":"0.70.17","Node name for S&R":"Display_Any","ue_properties":{"widget_ue_connectable":{},"version":"7.1","input_ue_unconnectable":{}}},"widgets_values":["Processing [z3nd4y4_99] 0 remaining. [02:37:05 AM]"],"color":"#432","bgcolor":"#653"},{"id":324,"type":"SAM3Segmentation","pos":[-5467.920161112771,-1092.8738901631002],"size":[270,262],"flags":{},"order":5,"mode":0,"inputs":[{"localized_name":"image","name":"image","type":"IMAGE","link":739},{"localized_name":"prompt","name":"prompt","type":"STRING","widget":{"name":"prompt"},"link":null},{"localized_name":"threshold","name":"threshold","type":"FLOAT","widget":{"name":"threshold"},"link":null},{"localized_name":"min_width_pixels","name":"min_width_pixels","type":"INT","widget":{"name":"min_width_pixels"},"link":null},{"localized_name":"min_height_pixels","name":"min_height_pixels","type":"INT","widget":{"name":"min_height_pixels"},"link":null},{"localized_name":"use_video_model","name":"use_video_model","type":"BOOLEAN","widget":{"name":"use_video_model"},"link":null},{"localized_name":"unload_after_run","name":"unload_after_run","type":"BOOLEAN","widget":{"name":"unload_after_run"},"link":null},{"localized_name":"object_ids","name":"object_ids","shape":7,"type":"STRING","widget":{"name":"object_ids"},"link":null}],"outputs":[{"localized_name":"segmented_image","name":"segmented_image","type":"IMAGE","links":[]},{"localized_name":"masks","name":"masks","type":"MASK","links":[897]},{"localized_name":"mask_combined","name":"mask_combined","type":"MASK","links":[]},{"localized_name":"segs","name":"segs","type":"SEGS","links":null}],"properties":{"Node name for S&R":"SAM3Segmentation","ue_properties":{"widget_ue_connectable":{"prompt":true,"threshold":true,"min_width_pixels":true,"min_height_pixels":true,"use_video_model":true,"unload_after_run":true,"object_ids":true},"version":"7.1","input_ue_unconnectable":{}}},"widgets_values":["person",0.1,0,0,false,false,""]},{"id":266,"type":"BK Print To Console With Boarder","pos":[-5421.856223498668,-744.0590408962971],"size":[310.7681640625,106],"flags":{},"order":7,"mode":0,"inputs":[{"localized_name":"text","name":"text","type":"STRING","widget":{"name":"text"},"link":569},{"localized_name":"char","name":"char","type":"STRING","widget":{"name":"char"},"link":null},{"localized_name":"length","name":"length","type":"INT","widget":{"name":"length"},"link":null}],"outputs":[{"localized_name":"text","name":"text","type":"STRING","links":null}],"properties":{"aux_id":"brandonkish/comfyUI-extractable-text","ver":"700e57effd7190916609392fcea90f47bbbaa3f1","Node name for S&R":"BK Print To Console With Boarder","ue_properties":{"widget_ue_connectable":{"text":true,"char":true,"length":true},"version":"7.1","input_ue_unconnectable":{}}},"widgets_values":["","#",75],"color":"#432","bgcolor":"#653"},{"id":242,"type":"BK Load Image By Path","pos":[-5805.263656091432,-1187.425692530105],"size":[270,246],"flags":{},"order":2,"mode":0,"inputs":[{"localized_name":"image_name","name":"image_name","type":"STRING","widget":{"name":"image_name"},"link":976},{"localized_name":"image_directory","name":"image_directory","type":"STRING","widget":{"name":"image_directory"},"link":980},{"localized_name":"extension","name":"extension","type":"STRING","widget":{"name":"extension"},"link":982}],"outputs":[{"localized_name":"image","name":"image","type":"IMAGE","links":[739,746]},{"localized_name":"mask","name":"mask","type":"MASK","links":[]},{"localized_name":"positive_prompt","name":"positive_prompt","type":"STRING","links":null},{"localized_name":"negative_prompt","name":"negative_prompt","type":"STRING","links":null},{"localized_name":"seed","name":"seed","type":"INT","links":[]},{"localized_name":"other","name":"other","type":"STRING","links":null},{"localized_name":"name","name":"name","type":"STRING","links":[]},{"localized_name":"folder_path","name":"folder_path","type":"STRING","links":null}],"properties":{"aux_id":"brandonkish/comfyUI-extractable-text","ver":"700e57effd7190916609392fcea90f47bbbaa3f1","Node name for S&R":"BK Load Image By Path","ue_properties":{"widget_ue_connectable":{"image_name":true,"image_directory":true,"extension":true},"version":"7.1","input_ue_unconnectable":{}}},"widgets_values":["image","",".png"]},{"id":402,"type":"VHS_GetMaskCount","pos":[-5128.719329220537,-914.3914814660465],"size":[416.7607421875,33.92762991966379],"flags":{},"order":8,"mode":0,"inputs":[{"localized_name":"mask","name":"mask","type":"MASK","link":897}],"outputs":[{"localized_name":"count","name":"count","type":"INT","links":[968]}],"title":"GET THE NUMBER OF MASKS THAT SAM RETURNED","properties":{"cnr_id":"comfyui-videohelpersuite","ver":"1.7.4","Node name for S&R":"VHS_GetMaskCount","ue_properties":{"widget_ue_connectable":{},"version":"7.1","input_ue_unconnectable":{}}},"widgets_values":{}},{"id":432,"type":"BK Is A Greater Than B INT","pos":[-4666.23210448745,-936.9621872104025],"size":[341.8691955954331,82],"flags":{},"order":9,"mode":0,"inputs":[{"localized_name":"a","name":"a","type":"INT","widget":{"name":"a"},"link":968},{"localized_name":"b","name":"b","type":"INT","widget":{"name":"b"},"link":null}],"outputs":[{"localized_name":"is_a_greater_than_b","name":"is_a_greater_than_b","type":"BOOLEAN","links":[969,987]}],"title":"IS MORE THAN ONE PERSON IN IMAGE?","properties":{"aux_id":"brandonkish/comfyUI-extractable-text","ver":"700e57effd7190916609392fcea90f47bbbaa3f1","Node name for S&R":"BK Is A Greater Than B INT","ue_properties":{"widget_ue_connectable":{"a":true,"b":true},"version":"7.1","input_ue_unconnectable":{}}},"widgets_values":[0,1]},{"id":434,"type":"Display_Any","pos":[-4266.328471595434,-889.3902652305546],"size":[215.67328467569223,76],"flags":{},"order":11,"mode":0,"inputs":[{"localized_name":"input","name":"input","type":"*","link":987}],"outputs":[{"localized_name":"STRING","name":"STRING","type":"STRING","links":null}],"title":"MOVE FILE?","properties":{"cnr_id":"kaytool","ver":"0.70.17","Node name for S&R":"Display_Any","ue_properties":{"widget_ue_connectable":{},"version":"7.1","input_ue_unconnectable":{}}},"widgets_values":["True"],"color":"#232","bgcolor":"#353"},{"id":431,"type":"BK Move File","pos":[-4230.943771206574,-1315.583364608343],"size":[479.0018947219037,306],"flags":{},"order":10,"mode":0,"inputs":[{"localized_name":"src_filename","name":"src_filename","type":"STRING","widget":{"name":"src_filename"},"link":977},{"localized_name":"src_folder_path","name":"src_folder_path","type":"STRING","widget":{"name":"src_folder_path"},"link":988},{"localized_name":"src_extension","name":"src_extension","type":"STRING","widget":{"name":"src_extension"},"link":983},{"localized_name":"dest_filename","name":"dest_filename","type":"STRING","widget":{"name":"dest_filename"},"link":979},{"localized_name":"dest_folder_path","name":"dest_folder_path","type":"STRING","widget":{"name":"dest_folder_path"},"link":981},{"localized_name":"dest_extension","name":"dest_extension","type":"STRING","widget":{"name":"dest_extension"},"link":984},{"localized_name":"dest_subfolder","name":"dest_subfolder","type":"STRING","widget":{"name":"dest_subfolder"},"link":null},{"localized_name":"is_move_file","name":"is_move_file","type":"BOOLEAN","widget":{"name":"is_move_file"},"link":969}],"outputs":[{"localized_name":"dest_filename","name":"dest_filename","type":"STRING","links":null},{"localized_name":"dest_folder_path","name":"dest_folder_path","type":"STRING","links":null},{"localized_name":"dest_extension","name":"dest_extension","type":"STRING","links":null},{"localized_name":"dest_full_path","name":"dest_full_path","type":"STRING","links":null},{"localized_name":"output_4","name":"output_4","type":"STRING","links":null}],"title":"MOVE FILE IF MORE THAN ONE PERSON FOUND","properties":{"aux_id":"brandonkish/comfyUI-extractable-text","ver":"700e57effd7190916609392fcea90f47bbbaa3f1","Node name for S&R":"BK Move File","ue_properties":{"widget_ue_connectable":{"is_move_file":true,"src_filename":true,"src_folder_path":true,"src_extension":true,"dest_filename":true,"dest_folder_path":true,"dest_extension":true,"dest_subfolder":true},"version":"7.1","input_ue_unconnectable":{}}},"widgets_values":["filename","","png","filename","","png","multiple_people",true]},{"id":325,"type":"PreviewImage","pos":[-5430.028269152865,-1715.6386558289255],"size":[501.2040160986644,476.3901929131496],"flags":{},"order":6,"mode":0,"inputs":[{"localized_name":"images","name":"images","type":"IMAGE","link":746}],"outputs":[],"properties":{"cnr_id":"comfy-core","ver":"0.3.77","Node name for S&R":"PreviewImage","ue_properties":{"widget_ue_connectable":{},"version":"7.1","input_ue_unconnectable":{}}},"widgets_values":[]},{"id":417,"type":"Note","pos":[-4467.579267299547,-1710.6818019517493],"size":[338.1914737905604,266.1191717538768],"flags":{},"order":0,"mode":0,"inputs":[],"outputs":[],"title":"SWITCH EXPLAINED","properties":{"ue_properties":{"widget_ue_connectable":{},"version":"7.1","input_ue_unconnectable":{}}},"widgets_values":["If SAM3 only returns 1 mask, there is only one person in the image. There is no need to edit or modify it. So We return input 1 which is the original image.\n\nIf SAM3 returns more than 1 mask, then there is more than one person detected. In this case we return the SAM3 Segmented version of the image since we will need to remove the additional people from the image in the next workflow.\n\nThe original image will always be stored in the \"1\" folder, since it only has one image.\n\nThe images with more than one person are stored in folders with the number of people in each one. This also assists in the next workflow."],"color":"#432","bgcolor":"#653"},{"id":433,"type":"BK File Select Next Unprocessed","pos":[-6376.576990606299,-908.6971334724099],"size":[306.878515625,266],"flags":{},"order":1,"mode":0,"inputs":[{"localized_name":"search_pattern","name":"search_pattern","type":"STRING","widget":{"name":"search_pattern"},"link":null},{"localized_name":"source_path","name":"source_path","type":"STRING","widget":{"name":"source_path"},"link":null},{"localized_name":"dest_path","name":"dest_path","type":"STRING","widget":{"name":"dest_path"},"link":null}],"outputs":[{"localized_name":"filename","name":"filename","type":"STRING","links":[976,977,979]},{"localized_name":"folder_path","name":"folder_path","type":"STRING","links":[980,981,988]},{"localized_name":"extension","name":"extension","type":"STRING","links":[982,983,984]},{"localized_name":"full_path","name":"full_path","type":"STRING","links":null},{"localized_name":"total_files_found","name":"total_files_found","type":"STRING","links":[985]},{"localized_name":"file_list","name":"file_list","type":"STRING","links":null},{"localized_name":"file_list_w_idx","name":"file_list_w_idx","type":"STRING","links":null},{"localized_name":"status","name":"status","type":"STRING","links":[986]},{"localized_name":"dest_folder","name":"dest_folder","type":"STRING","links":null}],"properties":{"aux_id":"brandonkish/comfyUI-extractable-text","ver":"700e57effd7190916609392fcea90f47bbbaa3f1","Node name for S&R":"BK File Select Next Unprocessed","ue_properties":{"widget_ue_connectable":{"search_pattern":true,"source_path":true,"dest_path":true},"version":"7.1","input_ue_unconnectable":{}}},"widgets_values":["*.png","images\\dataset_prep\\dataset_1024",""]}],"links":[[569,265,0,266,0,"STRING"],[739,242,0,324,0,"IMAGE"],[746,242,0,325,0,"IMAGE"],[897,324,1,402,0,"MASK"],[968,402,0,432,0,"INT"],[969,432,0,431,7,"BOOLEAN"],[976,433,0,242,0,"STRING"],[977,433,0,431,0,"STRING"],[979,433,0,431,3,"STRING"],[980,433,1,242,1,"STRING"],[981,433,1,431,4,"STRING"],[982,433,2,242,2,"STRING"],[983,433,2,431,2,"STRING"],[984,433,2,431,5,"STRING"],[985,433,4,264,0,"*"],[986,433,7,265,0,"*"],[987,432,0,434,0,"*"],[988,433,1,431,1,"STRING"]],"groups":[],"config":{},"extra":{"ds":{"scale":0.6115909044841487,"offset":[6263.0565455184405,1838.3412043806054]},"ue_links":[],"links_added_by_ue":[],"frontendVersion":"1.33.10","VHS_latentpreview":false,"VHS_latentpreviewrate":0,"VHS_MetadataImage":true,"VHS_KeepIntermediate":true,"workflowRendererVersion":"LG"},"version":0.4}